<mat-card>
  <mat-card-title>{{'ANALYSE_TITLE' | translate}}</mat-card-title>
</mat-card>
 
    <mat-horizontal-stepper [linear]="true" #stepper="matHorizontalStepper">
      <mat-step [stepControl]="countryFormGroup">
        <form [formGroup]="countryFormGroup" *ngIf="isAdmin">
          <ng-template matStepLabel>{{ 'SELECT_COUNTRY' | translate}}</ng-template>
          <bc-analyse-country [countries]="countries" (countryEmitter)="setCountry($event)" [form]="countryFormGroup" [inputName]="'country'"></bc-analyse-country>
          <div>
            <button mat-button matStepperNext>{{ 'NEXT' | translate}}</button>
          </div>
        </form>
      </mat-step>
      <mat-step [stepControl]="platformsFormGroup">
        <form [formGroup]="platformsFormGroup">
          <ng-template matStepLabel>{{ 'SELECT_PLATFORM' | translate}}</ng-template>
          <bc-analyse-platform [platforms]="platforms" (platformEmitter)="setPlatform($event)" [group]="platformsFormGroup" [inputName]="'platforms'"></bc-analyse-platform>
          <div>
            <button mat-button *ngIf="isAdmin"  matStepperPrevious>{{ 'BACK' | translate}}</button>
            <button mat-button matStepperNext>{{ 'NEXT' | translate}}</button>
          </div>
        </form>
      </mat-step>
      <mat-step [stepControl]="yearFormGroup">
        <form [formGroup]="yearFormGroup">
          <ng-template matStepLabel>{{ 'SELECT_YEAR' | translate}}</ng-template>
          <!--<bc-analyse-platform [platforms]="platforms" (platformEmitter)="setPlatform($event)" [group]="platformsFormGroup" [inputName]="'platforms'"></bc-analyse-platform>-->
          <div>
            <button mat-button  matStepperPrevious>{{ 'BACK' | translate}}</button>
            <button mat-button matStepperNext>{{ 'NEXT' | translate}}</button>
          </div>
        </form>
      </mat-step>

      <mat-step [stepControl]="surveysFormGroup">
        <form [formGroup]="surveysFormGroup">
          <ng-template matStepLabel>{{ 'SELECT_SURVEYS' | translate}}</ng-template>
          <!--<mat-form-field>
            <mat-select placeholder="{{ 'SELECT_SURVEYS' | translate}}" formControlName="surveys" (change)="setSurveys($event.value)" multiple required>
                <mat-select-trigger>
                  {{surveysFormGroup.controls.surveys.value ? surveysFormGroup.controls.surveys.value[0] : 'yo'}}
                  <span *ngIf="surveysFormGroup.controls.surveys.value?.length > 1">
                    (+{{surveysFormGroup.controls.surveys.value.length - 1}} others)
                  </span>
                </mat-select-trigger>
                <mat-option *ngFor="let survey of surveys" [value]="survey">{{survey.code}}</mat-option>
            </mat-select>
          </mat-form-field>-->
          <div>
            <button mat-button matStepperPrevious>{{ 'BACK' | translate}}</button>
            <button mat-button matStepperNext>{{ 'NEXT' | translate}}</button>
          </div>
        </form>
      </mat-step>
      <mat-step [stepControl]="zonesFormGroup">
        <form [formGroup]="zonesFormGroup">
          <ng-template matStepLabel>{{ 'SELECT_ZONES' | translate}}</ng-template>
          <!--<mat-tab-group>
            <mat-tab *ngFor="let zones of zonesFormGroup.controls.zones.controls; let i = index;">
                <ng-template mat-tab-label>{{currentSurveys[i].code}}</ng-template>
                <p>
                    {{'SURVEY_DATES' | translate}}:{{currentSurveys[i].dateStart | date:localDate}}, {{currentSurveys[i].dateEnd | date:localDate}}
                </p>
                <p>
                    {{'PARTICIPANTS' | translate}}: {{currentSurveys[i].participants}}
                </p>
                <mat-form-field [formGroup]="zones">
                    <mat-select placeholder="{{ 'SELECT_ZONES' | translate}}" formControlName="zones" (change)="setZones($event.value)" multiple required>
                        <mat-option *ngFor="let zone of zonesList[i]" [value]="zone">{{zone.code}}</mat-option>
                    </mat-select>
                </mat-form-field>
            </mat-tab>
          </mat-tab-group>-->
          <div>
            <button mat-button matStepperPrevious>{{ 'BACK' | translate}}</button>
            <button mat-button matStepperNext>{{ 'NEXT' | translate}}</button>
          </div>
        </form>
      </mat-step>
      <mat-step [stepControl]="transectsFormGroup" [optional]="true">
        <form [formGroup]="transectsFormGroup">
          <ng-template matStepLabel>{{ 'SELECT_TRANSECTS' | translate}}</ng-template>
          <!--<mat-tab-group>
            <mat-tab *ngFor="let transects of transectsList; let j = index;">
                <ng-template mat-tab-label>{{currentSurveys[j].code}}</ng-template>
                <p>
                    {{currentSurveys[j].dateStart | date:localDate}}, {{currentSurveys[j].dateEnd | date:localDate}}
                </p>
                <p>
                    {{'PARTICIPANTS' | translate}}: {{currentSurveys[j].participants}}
                </p>
                <mat-form-field>
                    <mat-select placeholder="{{ 'SELECT_TRANSECTS' | translate}}" formControlName="transects" multiple required>                       
                        <mat-option *ngFor="let transect of transects" [value]="transect">{{transect.code}}</mat-option>
                    </mat-select>
                </mat-form-field>
            </mat-tab>
        </mat-tab-group>-->
          <div>
            <button mat-button matStepperPrevious>{{ 'BACK' | translate}}</button>
            <button mat-button matStepperNext>{{ 'NEXT' | translate}}</button>
          </div>
        </form>
      </mat-step>
      <mat-step [stepControl]="speciesFormGroup">
        <form [formGroup]="speciesFormGroup">
          <ng-template matStepLabel>{{ 'SELECT_SPECIES' | translate}}</ng-template>
         <!-- <mat-form-field>
            <mat-select placeholder="{{ 'SELECT_SPECIES' | translate}}" formControlName="species" multiple required>
                <mat-option *ngFor="let sp of species" [value]="sp">{{sp.code}}</mat-option>
            </mat-select>
          </mat-form-field> -->
          <div>
            <button mat-button matStepperPrevious>{{ 'BACK' | translate}}</button>
            <button mat-button matStepperNext>{{ 'NEXT' | translate}}</button>
          </div>
        </form>
      </mat-step>
      <mat-step [stepControl]="analyseFormGroup">
        <form [formGroup]="analyseFormGroup">
          <ng-template matStepLabel>{{ 'START_ANALYSE' | translate}}</ng-template>
          
          <button mat-button (click)="stepper.submit()">{{ 'START_ANALYSE' | translate}}</button>
        </form>
        <div>
          <button mat-button matStepperPrevious>{{ 'BACK' | translate}}</button>
          <button mat-button (click)="stepper.reset()">{{ 'RESET' | translate}}</button>
        </div>
      </mat-step>
    </mat-horizontal-stepper>
     
